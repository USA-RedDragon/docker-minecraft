{
    "$schema": "https://docs.renovatebot.com/renovate-schema.json",
    "extends": [
        "local>USA-RedDragon/renovate-configs"
    ],
    "baseBranches": ["main", "/^mc\\/.*/"],
    "regexManagers": [
        {
            "fileMatch": ["(^|/)Dockerfile\\.paper$"],
            "matchStrings": ["ARG PAPER_VERSION=(?<currentValue>.*)"],
            "depNameTemplate": "paper-minecraft",
            "versioningTemplate": "semver-coerced",
            "datasourceTemplate": "custom.paper-minecraft"
        },
        {
            "fileMatch": ["(^|/)Dockerfile\\.paper$"],
            "matchStrings": ["ARG PAPER_VERSION=(?<mcVersion>.*)\\nARG PAPER_BUILD=(?<currentValue>.*)"],
            "depNameTemplate": "paper-{{{mcVersion}}}-builds",
            "versioningTemplate": "loose",
            "datasourceTemplate": "custom.paper-{{{mcVersion}}}-builds"
        }
    ],
    "customDatasources": {
        "paper-minecraft": {
            "defaultRegistryUrlTemplate": "https://api.papermc.io/v2/projects/paper",
            "transformTemplates": [
                "{\"releases\":[{\"version\": $$.versions[-1],\"sourceUrl\":\"https://github.com/PaperMC/Paper\",\"changelogUrl\":\"https://papermc.io/downloads/all\"}],\"sourceUrl\": \"https://github.com/PaperMC/Paper\",\"homepage\": \"https://papermc.io\"}"
            ]
        },
        "paper-1.20.1-builds": {
            "defaultRegistryUrlTemplate": "https://api.papermc.io/v2/projects/paper/versions/1.20.1/builds",
            "transformTemplates": [
                "{\"releases\":[{\"version\": $string($$.builds[-1].build),\"sourceUrl\":\"https://github.com/PaperMC/Paper\",\"changelogUrl\":\"https://papermc.io/downloads/all\"}],\"sourceUrl\": \"https://github.com/PaperMC/Paper\",\"homepage\": \"https://papermc.io\"}"
            ]
        },
        "paper-1.20.2-builds": {
            "defaultRegistryUrlTemplate": "https://api.papermc.io/v2/projects/paper/versions/1.20.2/builds",
            "transformTemplates": [
                "{\"releases\":[{\"version\": $string($$.builds[-1].build),\"sourceUrl\":\"https://github.com/PaperMC/Paper\",\"changelogUrl\":\"https://papermc.io/downloads/all\"}],\"sourceUrl\": \"https://github.com/PaperMC/Paper\",\"homepage\": \"https://papermc.io\"}"
            ]
        }
    },
    "packageRules": [
        {
            "matchPackagePatterns": ["^paper-minecraft$"],
            "matchBaseBranches": ["/^mc\\/1\\.20\\.1/"],
            "allowedVersions": "<=1.20.1"
        },
        {
            "matchPackagePatterns": ["^paper-minecraft$"],
            "matchBaseBranches": ["/^mc\\/1\\.20\\.2/"],
            "allowedVersions": "<=1.20.2"
        }
    ]
}
